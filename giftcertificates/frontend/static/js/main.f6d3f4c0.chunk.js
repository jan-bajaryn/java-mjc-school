(this["webpackJsonpfront-end-react"]=this["webpackJsonpfront-end-react"]||[]).push([[0],{123:function(e,t,a){},142:function(e,t,a){},174:function(e,t,a){},176:function(e,t,a){},177:function(e,t,a){},222:function(e,t,a){a(19).interceptors.request.use((function(e){var t=localStorage.getItem("authorization");return console.log("jwtToken = "+t),t&&!e.headers.Authorization&&(e.headers.Authorization="Bearer "+t),e}),(function(e){return console.log("err = "+e),Promise.reject(e)}))},223:function(e,t,a){},224:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a(1),s=a.n(n),i=a(23),c=a.n(i),o=(a(123),a(17)),l=a(18),d=a(41),u=a(7),h=a(8),p=a(16),m=a(15),j=a(19),b=a.n(j),g=function(){function e(){Object(u.a)(this,e),this._id=0,this._name="",this._description="",this._price=0,this._createDate=new Date,this._lastUpdateDate=new Date,this._duration=0,this._tags=[]}return Object(h.a)(e,[{key:"id",get:function(){return this._id},set:function(e){this._id=e}},{key:"name",get:function(){return this._name},set:function(e){this._name=e}},{key:"description",get:function(){return this._description},set:function(e){this._description=e}},{key:"price",get:function(){return this._price},set:function(e){this._price=e}},{key:"createDate",get:function(){return this._createDate},set:function(e){this._createDate=e}},{key:"lastUpdateDate",get:function(){return this._lastUpdateDate},set:function(e){this._lastUpdateDate=e}},{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e}},{key:"tags",get:function(){return this._tags},set:function(e){this._tags=e}}],[{key:"parse",value:function(t){var a=new e;return a.id=t.id,a.name=t.name,a.description=t.description,a.price=t.price,a.duration=t.duration,a.createDate=new Date(t.createDate),a.lastUpdateDate=new Date(t.lastUpdateDate),a.tags=t.tags.map((function(e){return e.name})),a}},{key:"parseCertificateList",value:function(t){for(var a=[],r=0;r<t.length;r++){var n=t[r];console.log("obj.name = "+n.name),a.push(e.parse(n))}return a}}]),e}(),f=(a(59),a(142),function(){function e(){Object(u.a)(this,e)}return Object(h.a)(e,null,[{key:"calcItemCount",value:function(){return Array.from(this.getBasket().values()).reduce((function(e,t){return e+t}),0)}},{key:"putItemBasket",value:function(e){var t=this.getBasket(),a=t.get(e);a?t.set(e,a+1):t.set(e,1),this.saveBasket(t)}},{key:"removeItemBasket",value:function(e){var t=this.getBasket(),a=t.get(e);if(a){var r=a-1;r<1?t.delete(e):t.set(e,r),this.saveBasket(t)}}},{key:"saveBasket",value:function(e){console.log("save basket = ",JSON.stringify(Array.from(e.entries()))),localStorage.setItem("cart",JSON.stringify(Array.from(e.entries())))}},{key:"logout",value:function(){localStorage.removeItem("authorization"),localStorage.removeItem("refresh_token"),localStorage.removeItem("role"),localStorage.removeItem("userId"),localStorage.removeItem("username"),localStorage.removeItem("name")}},{key:"login",value:function(e,t,a,r,n,s){localStorage.setItem("authorization",e),localStorage.setItem("refresh_token",t),localStorage.setItem("role",a),localStorage.setItem("userId",r),localStorage.setItem("username",n),s?localStorage.setItem("name",s):localStorage.removeItem("name")}},{key:"isLogged",value:function(){return null!==localStorage.getItem("authorization")}},{key:"getBasket",value:function(){var e=localStorage.getItem("cart");return null===e?new Map([]):new Map(JSON.parse(e))}},{key:"getUserId",value:function(){return localStorage.getItem("userId")}},{key:"clearBasket",value:function(){localStorage.removeItem("cart")}},{key:"getRole",value:function(){return localStorage.getItem("role")}},{key:"getName",value:function(){return localStorage.getItem("name")}},{key:"removeAllItemBasket",value:function(e){var t=this.getBasket();t.delete(e),this.saveBasket(t)}}]),e}()),x=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var r;return Object(u.a)(this,a),(r=t.call(this,e)).state={role:null,username:null},r}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("role"),t=localStorage.getItem("username");console.log("Header: role = "+e),this.setState({role:e,username:t})}},{key:"render",value:function(){var e=this;return Object(r.jsxs)("nav",{className:"navbar navbar-expand-lg navbar-light justify-content-center fixed-top bg-white",children:[Object(r.jsx)(o.b,{to:"/",className:"navbar-brand",href:"#",children:"Home"}),Object(r.jsx)("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(r.jsx)("span",{className:"navbar-toggler-icon"})}),Object(r.jsxs)("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:[Object(r.jsx)("ul",{className:"navbar-nav mr-auto",children:"ADMIN"===this.state.role&&Object(r.jsx)("li",{className:"nav-item active",children:Object(r.jsxs)(o.b,{className:"nav-link",to:"/admin/certificates",children:["Certificates",Object(r.jsx)("span",{className:"sr-only",children:"(current)"})]})})}),Object(r.jsxs)("ul",{className:"navbar-nav",children:[Object(r.jsx)("li",{className:"nav-item",children:Object(r.jsx)(o.b,{to:"/orders",className:"nav-link",children:this.state.username&&Object(r.jsx)("span",{children:this.state.username})})}),Object(r.jsx)("li",{className:"nav-item",children:Object(r.jsxs)(o.b,{to:"/basket",className:"nav-link",children:[Object(r.jsx)("i",{className:"material-icons",children:"shopping_cart"}),this.props.cartItems?Object(r.jsx)("small",{children:this.props.cartItems}):Object(r.jsx)("small",{children:f.calcItemCount()})]})}),Object(r.jsx)("li",{className:"nav-item",children:Object(r.jsx)(o.b,{to:"/login",className:"nav-link",children:"Login"})}),Object(r.jsx)("li",{className:"nav-item",children:Object(r.jsx)(o.b,{to:"/register",className:"nav-link",children:"Sign Up"})}),f.isLogged()&&Object(r.jsx)("li",{className:"nav-item",children:Object(r.jsx)(o.b,{to:"/logout",onClick:function(t){t.preventDefault(),f.logout(),e.props.history.push("/login"),window.location.reload()},className:"nav-link",children:"Log out"})})]})]})]})}}]),a}(n.Component),O=Object(l.e)(x),v=a(50),N=a.n(v),y=function(){function e(){Object(u.a)(this,e)}return Object(h.a)(e,null,[{key:"handleTokenExpired",value:function(t,a,r){t&&t.response&&t.response.status&&t.response.data&&t.response.data.error&&401===t.response.status&&"invalid_token"===t.response.data.error&&e.tryRefreshToken(a,r)}},{key:"tryRefreshToken",value:function(e,t){var a=localStorage.getItem("refresh_token");if(console.log("refresh token to use = "+a),a){console.log("enter refresh procedure");var r=new URLSearchParams;r.append("grant_type","refresh_token"),r.append("refresh_token",a),console.log("before send request refresh procedure"),b.a.post("http://localhost:9000/oauth/token",r,{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic Y2xpZW50aWQ6cGFzc3dvcmQ="}}).then((function(t){console.log("refresh procedure success"),f.login(t.data.access_token,t.data.refresh_token,t.data.role,t.data.id,t.data.username,t.data.name),e()})).catch((function(e){console.log("refresh procedure error"),console.log("error refresh procedure = "+e),f.logout(),t()}))}}}]),e}(),k=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){var e=this;return Object(r.jsxs)("div",{className:"row m-5 align-middle",children:[Object(r.jsxs)("ul",{className:"pagination justify-content-center pagination-lg col-10",children:[!this.props.pageNumber||this.props.pageNumber<=1?Object(r.jsx)("li",{className:"page-item disabled",children:Object(r.jsx)("a",{className:"page-link",href:"?",children:"Previous"})}):Object(r.jsx)("li",{className:"page-item",children:Object(r.jsx)("a",{className:"page-link",href:"?",onClick:function(t){return e.props.onClickPagination(t,e.props.pageNumber-1)},children:"Previous"})}),1!==this.props.pageNumber&&0!==this.props.totalPageCount&&Object(r.jsx)("li",{className:"page-item",children:Object(r.jsx)("a",{className:"page-link",href:"?",onClick:function(t){return e.props.onClickPagination(t,1)},children:"1"})}),0!==this.props.totalPageCount&&[this.props.pageNumber-3,this.props.pageNumber-2,this.props.pageNumber-1].map((function(t,a){return t>1&&Object(r.jsx)("li",{className:"page-item",children:Object(r.jsx)("a",{className:"page-link",href:"?",onClick:function(a){return e.props.onClickPagination(a,t)},children:t})},a)})),0!==this.props.totalPageCount&&Object(r.jsx)("li",{className:"page-item active",children:Object(r.jsx)("a",{className:"page-link",href:"?",onClick:function(t){return e.props.onClickPagination(t,e.props.pageNumber)},children:this.props.pageNumber})}),0!==this.props.totalPageCount&&[this.props.pageNumber+1,this.props.pageNumber+2,this.props.pageNumber+3].map((function(t,a){return e.props.totalPageCount>t&&Object(r.jsx)("li",{className:"page-item",children:Object(r.jsx)("a",{className:"page-link",href:"?",onClick:function(a){return e.props.onClickPagination(a,t)},children:t})},a)})),0!==this.props.totalPageCount&&this.props.totalPageCount!==this.props.pageNumber&&Object(r.jsx)("li",{className:"page-item",children:Object(r.jsx)("a",{className:"page-link",href:"?",onClick:function(t){return e.props.onClickPagination(t,e.props.totalPageCount)},children:this.props.totalPageCount})}),this.props.totalPageCount>this.props.pageNumber?Object(r.jsx)("li",{className:"page-item",children:Object(r.jsx)("a",{className:"page-link",href:"?",onClick:function(t){return e.props.onClickPagination(t,e.props.pageNumber+1)},children:"Next"})}):Object(r.jsx)("li",{className:"page-item disabled",children:Object(r.jsx)("a",{className:"page-link",href:"?",children:"Next"})})]}),Object(r.jsx)("div",{className:"form-group w-10 col-2",children:Object(r.jsx)("label",{children:Object(r.jsxs)("select",{className:"form-control btn-lg",value:this.props.pageSize,onChange:function(t){return e.props.changePageSize(t)},children:[Object(r.jsx)("option",{children:"5"}),Object(r.jsx)("option",{children:"10"}),Object(r.jsx)("option",{children:"15"}),Object(r.jsx)("option",{children:"20"}),Object(r.jsx)("option",{children:"25"}),Object(r.jsx)("option",{children:"30"}),Object(r.jsx)("option",{children:"50"}),Object(r.jsx)("option",{children:"100"})]})})})]})}}]),a}(n.Component),S=(a(174),function(){function e(){Object(u.a)(this,e)}return Object(h.a)(e,null,[{key:"setParamQueryArray",value:function(e,t,a){console.log("enter method setParamQueryArray"),0!==t.length?(console.log("set something"),e.set(a,t.join(","))):e.delete(a)}},{key:"setParamQuery",value:function(e,t,a){t?e.set(a,t):e.delete(a)}}]),e}()),w=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var r;return Object(u.a)(this,a),(r=t.call(this,e)).handleAddTag=function(e){r.setState((function(t){return{tagNames:[].concat(Object(d.a)(t.tagNames),[e])}}))},r.handleDeleteTag=function(e){r.setState({tagNames:r.state.tagNames.filter((function(t){return t!==e}))})},r.state={items:[],displayFilters:!1,partName:"",partDescription:"",itemCount:f.calcItemCount(),pageNumber:1,pageSize:5,totalPageCount:1e3,tagNames:[],sort:"LAST_UPDATE:asc"},console.log("before build search"),r}return Object(h.a)(a,[{key:"buildSearch",value:function(e){var t=new URLSearchParams(e),a=t.get("tagNames");a&&this.setState({tagNames:a.split(",")});var r=t.get("pageSize");r&&this.setState({pageSize:Number.parseInt(r)});var n=t.get("pageNumber");n&&this.setState({pageNumber:Number.parseInt(n)});var s=t.get("partName");console.log("partName in buildSearch = "+s),s&&this.setState({partName:s});var i=t.get("partDescription");i&&this.setState({partDescription:i});var c=t.get("sort");c&&this.setState({sort:c})}},{key:"componentDidMount",value:function(){this.loadResources(this.props.location.search),this.buildSearch(this.props.location.search)}},{key:"loadResources",value:function(e){var t=this,a="http://localhost:8080/certificates"+e;console.log("loadResources, location = "+e),b.a.get(a).then((function(e){var a=e.data.items,r=e.data.totalPageCount;console.log("data = "+a),console.log("totalPageCount = "+r);var n=g.parseCertificateList(a);t.setState({items:n,totalPageCount:r})})).catch((function(a){console.log("error = "+a),y.handleTokenExpired(a,(function(){return t.loadResources(e)}),(function(){return window.location.reload()}))}))}},{key:"render",value:function(){var e=this;return Object(r.jsxs)("div",{children:[Object(r.jsx)(O,{cartItems:this.state.itemCount}),Object(r.jsx)("div",{className:"container my-3 pt-5 text-center",children:this.state.displayFilters?Object(r.jsx)("button",{className:"btn btn-primary",onClick:function(){return e.toggleFilter()},children:"Hide filters"}):Object(r.jsx)("button",{className:"btn btn-primary",onClick:function(){return e.toggleFilter()},children:"Show Filters"})}),this.state.displayFilters&&Object(r.jsx)("div",{className:"d-flex justify-content-center",children:Object(r.jsxs)("div",{className:"form__container mx-5 mb-5 w-50 text-center",children:[Object(r.jsxs)("div",{className:"row text-center",children:[Object(r.jsx)("div",{className:"form-group col-6",children:Object(r.jsx)("input",{type:"text",className:"form-control",placeholder:"Enter name",id:"partName",value:this.state.partName,onChange:function(t){return e.setState({partName:t.target.value})}})}),Object(r.jsx)("div",{className:"form-group col-6",children:Object(r.jsx)("input",{type:"text",className:"form-control",placeholder:"Enter description",id:"partDescription",value:this.state.partDescription,onChange:function(t){return e.setState({partDescription:t.target.value})}})})]}),Object(r.jsxs)("div",{className:"form-group text-center row",children:[Object(r.jsx)("div",{className:"col-6 text-left chip__array",children:Object(r.jsx)(N.a,{label:"Tags",value:this.state.tagNames,onAdd:function(t){return e.handleAddTag(t)},onDelete:function(t){return e.handleDeleteTag(t)}})}),Object(r.jsx)("div",{className:"col-6 text-center",children:Object(r.jsxs)("div",{className:"radio text-left",children:[Object(r.jsxs)("div",{className:"form-check",children:[Object(r.jsx)("input",{className:"form-check-input",type:"radio",name:"sort",id:"exampleRadios1",value:"LAST_UPDATE:asc",checked:"LAST_UPDATE:asc"===this.state.sort,onChange:function(){return e.setState({sort:"LAST_UPDATE:asc"})}}),Object(r.jsx)("label",{className:"form-check-label",htmlFor:"exampleRadios1",children:"Sort by last update"})]}),Object(r.jsxs)("div",{className:"form-check",children:[Object(r.jsx)("input",{className:"form-check-input",type:"radio",name:"sort",id:"exampleRadios2",value:"NAME:asc",checked:"NAME:asc"===this.state.sort,onChange:function(){return e.setState({sort:"NAME:asc"})}}),Object(r.jsx)("label",{className:"form-check-label",htmlFor:"exampleRadios2",children:"Sort by name"})]})]})})]}),Object(r.jsx)("button",{onClick:function(){return e.filter()},className:"btn btn-primary",children:"Submit"})]})}),Object(r.jsx)("main",{className:"main-page",children:Object(r.jsx)("div",{className:"coupon_list",children:this.state.items&&this.state.items.map((function(t,a){return Object(r.jsxs)("div",{className:"card mx-2 my-4",children:[Object(r.jsx)("h2",{className:"card-title card-header text-center",children:t.name}),Object(r.jsx)("div",{className:"card-body-header p-3",children:Object(r.jsx)("p",{className:"card-text",children:t.description.substr(0,100)})}),Object(r.jsxs)("ul",{className:"list-group list-group-flush",children:[Object(r.jsx)("li",{className:"list-group-item",children:Object(r.jsx)("span",{children:"Expires in 4 days"})}),Object(r.jsxs)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[Object(r.jsxs)("span",{children:["$",t.price]}),Object(r.jsx)("span",{children:Object(r.jsx)("button",{className:"btn btn-secondary",onClick:function(){return e.addCard(t.id)},children:"Add to Cart"})})]})]}),Object(r.jsx)("div",{className:"card-body text-left",children:t.tags.map((function(t,a){return Object(r.jsx)("span",{className:"mr-1",children:Object(r.jsxs)(o.b,{to:"/?tagNames="+t,onClick:function(){return e.setState({tagNames:[t],partName:"",partDescription:"",sort:"LAST_UPDATE:asc",pageNumber:1},(function(){return e.filter()}))},children:["#",t]})},a)}))})]},a)}))})}),Object(r.jsx)(k,{pageNumber:this.state.pageNumber,pageSize:this.state.pageSize,totalPageCount:this.state.totalPageCount,onClickPagination:function(t,a){return e.onClickPagination(t,a)},changePageSize:function(t){return e.changePageSize(t)}})]})}},{key:"changePageSize",value:function(e){var t=this;this.setState((function(){return{pageNumber:1,pageSize:Number.parseInt(e.target.value)}}),(function(){return t.filter()}))}},{key:"filter",value:function(){var e=new URLSearchParams(this.props.location.search);S.setParamQuery(e,this.state.partName,"partName"),S.setParamQuery(e,this.state.partDescription,"partDescription"),S.setParamQuery(e,this.state.pageNumber,"pageNumber"),S.setParamQuery(e,this.state.pageSize,"pageSize"),S.setParamQuery(e,this.state.sort,"sort"),S.setParamQueryArray(e,this.state.tagNames,"tagNames");var t="?"+e.toString();this.props.history.replace(t),this.loadResources(t),this.buildSearch(t)}},{key:"addCard",value:function(e){f.putItemBasket(e),this.setState({itemCount:f.calcItemCount()})}},{key:"toggleFilter",value:function(){this.setState((function(e){return{displayFilters:!e.displayFilters}}))}},{key:"onClickPagination",value:function(e,t){var a=this;e.preventDefault(),console.log("onclick pagination = "+t),this.setState({pageNumber:t},(function(){return a.filter()}))}}]),a}(n.Component),C=Object(l.e)(w),P=a(31),_=a.n(P),D=a(44),I=(a(176),function(){function e(){Object(u.a)(this,e)}return Object(h.a)(e,null,[{key:"exctractRef",value:function(e){return e.current?e.current.value:""}}]),e}()),E=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var r;return Object(u.a)(this,a),(r=t.call(this,e)).username=s.a.createRef(),r.password=s.a.createRef(),r.handleSubmit=function(){var e=Object(D.a)(_.a.mark((function e(t){var a,n,s,i,c;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a="http://localhost:9000/oauth/token",n=I.exctractRef(r.username),s=I.exctractRef(r.password),r.validateForm(n,s)){e.next=6;break}return e.abrupt("return");case 6:console.log("username = "+n),console.log("password = "+s),(i=new URLSearchParams).append("grant_type","password"),i.append("username",n),i.append("password",s),c={"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic Y2xpZW50aWQ6cGFzc3dvcmQ="},b.a.post(a,i,{headers:c}).then((function(e){f.login(e.data.access_token,e.data.refresh_token,e.data.role,e.data.id,e.data.username,e.data.name),r.props.history.push("/")})).catch((function(e){400===e.response.status&&"invalid_grant"===e.response.data.error&&r.setState({bad_credentials:!0})}));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.state={bad_credentials:!1,bad_username:!1,bad_password:!1},r}return Object(h.a)(a,[{key:"validateForm",value:function(e,t){var a=!0;return(!e||""===e||e.length<3||e.length>30)&&(this.setState({bad_username:!0}),a=!1),(!t||""===t||t.length<4||t.length>30)&&(this.setState({bad_password:!0}),a=!1),a}},{key:"render",value:function(){var e=this;return Object(r.jsxs)("div",{children:[Object(r.jsx)(O,{cartItems:f.calcItemCount()}),Object(r.jsx)("main",{className:"pt-5 mt-5 login",children:Object(r.jsxs)("div",{className:"form-login",children:[Object(r.jsx)("div",{className:"logo_container",children:Object(r.jsx)("div",{className:"logo_place",children:Object(r.jsx)("span",{children:"Logo"})})}),Object(r.jsxs)("form",{onSubmit:this.handleSubmit,noValidate:!0,children:[Object(r.jsx)("div",{children:this.state.bad_username?Object(r.jsxs)("label",{children:[Object(r.jsx)("input",{type:"text",placeholder:"Login",ref:this.username,className:"is-invalid form-control",onChange:function(){return e.setState({bad_username:!1})}}),Object(r.jsx)("br",{}),Object(r.jsx)("span",{className:"error_message",children:"Incorrect Username"})]}):Object(r.jsx)("label",{children:Object(r.jsx)("input",{type:"text",className:"form-control",placeholder:"Login",ref:this.username})})}),Object(r.jsx)("div",{children:this.state.bad_password?Object(r.jsxs)("label",{children:[Object(r.jsx)("input",{type:"password",placeholder:"Password",ref:this.password,className:"is-invalid form-control",onChange:function(){return e.setState({bad_password:!1})}}),Object(r.jsx)("br",{}),Object(r.jsx)("span",{className:"error_message",children:"Incorrect Password"})]}):Object(r.jsx)("label",{children:Object(r.jsx)("input",{type:"password",className:"form-control",placeholder:"Password",ref:this.password})})}),this.state.bad_credentials&&Object(r.jsx)("div",{className:"alert alert-warning",role:"alert",children:"Incorrect Login Or Password"}),Object(r.jsx)("div",{children:Object(r.jsx)("button",{children:"Login"})})]})]})})]})}}]),a}(n.Component),T=Object(l.e)(E),M=(a(177),function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var r;return Object(u.a)(this,a),(r=t.call(this,e)).username=s.a.createRef(),r.password=s.a.createRef(),r.repeat_password=s.a.createRef(),r.name=s.a.createRef(),r.handleSubmit=function(){var e=Object(D.a)(_.a.mark((function e(t){var a,n,s,i,c,o;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a="http://localhost:8080/users",n=I.exctractRef(r.username),s=I.exctractRef(r.password),i=I.exctractRef(r.repeat_password),c=I.exctractRef(r.name),r.isFormValid(n,s,i,c)){e.next=8;break}return e.abrupt("return");case 8:o={username:n,password:s,name:c},b.a.post(a,o).then((function(){r.props.history.push("/login")})).catch((function(e){"40026"===e.response.data.errorCode&&r.setState({err_msg:"User with so username already exists"}),"40019"===e.response.data.errorCode&&r.setState({err_msg:e.response.data.message}),console.log("login error = "+e),y.handleTokenExpired(e,(function(){return r.handleSubmit(t)}),(function(){return window.location.reload()}))}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.state={bad_name:!1,bad_password:!1,bad_username:!1,bad_repeat_password:!1},r}return Object(h.a)(a,[{key:"isFormValid",value:function(e,t,a,r){var n=!0;return(!e||""===e||e.length<3||e.length>30)&&(this.setState({bad_username:!0}),n=!1),(!t||""===t||t.length<4||t.length>30)&&(this.setState({bad_password:!0}),n=!1),a&&""!==a&&t===a||(this.setState({bad_repeat_password:!0}),n=!1),r&&(/\s/.test(r)||r.length>20)&&(this.setState({bad_name:!0}),n=!1),n}},{key:"render",value:function(){var e=this;return Object(r.jsxs)("div",{children:[Object(r.jsx)(O,{cartItems:f.calcItemCount()}),Object(r.jsx)("main",{className:"mt-5 pt-5 register_container",children:Object(r.jsxs)("div",{className:"register_container",children:[Object(r.jsx)("div",{className:"logo_container",children:Object(r.jsx)("span",{children:"Register"})}),this.state.err_msg&&Object(r.jsx)("div",{className:"alert alert-warning",role:"alert",children:this.state.err_msg}),Object(r.jsx)("div",{className:"inputs_container",children:Object(r.jsxs)("form",{onSubmit:this.handleSubmit,noValidate:!0,children:[Object(r.jsxs)("div",{className:"first_column",children:[Object(r.jsxs)("div",{className:"item",children:[Object(r.jsx)("label",{htmlFor:"login_name",children:"Login Name"}),this.state.bad_username?Object(r.jsx)("input",{type:"text",id:"login_name",ref:this.username,className:"form-control is-invalid",onChange:function(){return e.setState({bad_username:!1})}}):Object(r.jsx)("input",{type:"text",id:"login_name",ref:this.username,className:"form-control"})]}),Object(r.jsxs)("div",{className:"item",children:[Object(r.jsx)("label",{htmlFor:"password",children:"Password"}),this.state.bad_password?Object(r.jsx)("input",{type:"password",id:"password",ref:this.password,className:"form-control is-invalid",onChange:function(){return e.setState({bad_password:!1})}}):Object(r.jsx)("input",{type:"password",id:"password",ref:this.password,className:"form-control"})]})]}),Object(r.jsxs)("div",{className:"second_column",children:[Object(r.jsxs)("div",{className:"item",children:[Object(r.jsx)("label",{htmlFor:"name",children:"Your Name"}),this.state.bad_name?Object(r.jsx)("input",{type:"text",id:"name",ref:this.name,className:"form-control is-invalid",onChange:function(){return e.setState({bad_name:!1})}}):Object(r.jsx)("input",{type:"text",id:"name",ref:this.name,className:"form-control"})]}),Object(r.jsxs)("div",{className:"item",children:[Object(r.jsx)("label",{htmlFor:"repeat_password",children:"Repeat Password"}),this.state.bad_repeat_password?Object(r.jsx)("input",{type:"password",id:"repeat_password",ref:this.repeat_password,className:"form-control is-invalid",onChange:function(){return e.setState({bad_repeat_password:!1})}}):Object(r.jsx)("input",{type:"password",id:"repeat_password",ref:this.repeat_password,className:"form-control"})]}),Object(r.jsx)("div",{className:"item",children:Object(r.jsxs)("div",{className:"btn_holder",children:[Object(r.jsx)("button",{className:"transparent_bg",type:"reset",children:"Cancel"}),Object(r.jsx)("button",{className:"green_bg",children:"Sign Up"})]})})]})]})})]})})]})}}]),a}(n.Component)),F=Object(l.e)(M),A=(a(178),a(56)),R=a.n(A),z=function(){function e(){Object(u.a)(this,e)}return Object(h.a)(e,null,[{key:"dateParseString",value:function(e){return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDay()+" "+e.getHours()+":"+e.getMinutes()}}]),e}(),L=a(247),U=a(243),B=a(244),Q=a(245),V=a(246),J=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){var e=this;return Object(r.jsxs)(L.a,{isOpen:this.props.showCreateOrEditModal,toggle:function(){return e.props.toggle()},children:[Object(r.jsx)(U.a,{toggle:function(){return e.props.toggle()},children:Object(r.jsxs)("h5",{className:"modal-title",id:"editModalLabel",children:[this.props.writeOrEditCaption&&Object(r.jsx)("span",{children:this.props.writeOrEditCaption})," certificate"]})}),Object(r.jsxs)(B.a,{children:[this.props.errText&&Object(r.jsx)(Q.a,{color:"warning",children:this.props.errText}),Object(r.jsxs)("div",{className:"form-group text-left",children:[Object(r.jsx)("label",{htmlFor:"name",children:"Name"}),this.props.wrongEditName?Object(r.jsx)("input",{type:"text",className:"form-control is-invalid",placeholder:"Enter Name",value:this.props.editName,onChange:function(t){return e.props.onNameChange(t)},id:"name"}):Object(r.jsx)("input",{type:"text",className:"form-control",placeholder:"Enter Name",value:this.props.editName,onChange:function(t){return e.props.onNameChange(t)},id:"name"})]}),Object(r.jsxs)("div",{className:"form-group text-left",children:[Object(r.jsx)("label",{htmlFor:"description",children:"Description:"}),this.props.wrongEditDescription?Object(r.jsx)("textarea",{className:"form-control is-invalid",rows:5,id:"description",value:this.props.editDescription,onChange:function(t){return e.props.onDescriptionChange(t)},placeholder:"Enter Description"}):Object(r.jsx)("textarea",{className:"form-control",rows:5,id:"description",value:this.props.editDescription,onChange:function(t){return e.props.onDescriptionChange(t)},placeholder:"Enter Description"})]}),Object(r.jsxs)("div",{className:"form-group text-left",children:[Object(r.jsx)("label",{htmlFor:"price",children:"Price"}),isNaN(this.props.editPrice)?Object(r.jsx)("input",{type:"number",step:"any",className:"form-control is-invalid",value:this.props.editPrice,placeholder:"Enter Price",min:0,onChange:function(t){return e.props.onPriceChange(t)},id:"price"}):Object(r.jsx)("input",{type:"number",step:"any",className:"form-control",value:this.props.editPrice,placeholder:"Enter Price",min:0,onChange:function(t){return e.props.onPriceChange(t)},id:"price"})]}),Object(r.jsxs)("div",{className:"form-group text-left",children:[Object(r.jsx)("label",{htmlFor:"duration",children:"Duration"}),isNaN(this.props.editDuration)?Object(r.jsx)("input",{type:"number",className:"form-control is-invalid",placeholder:"Enter Duration",value:this.props.editDuration,min:0,onChange:function(t){return e.props.onDurationChange(t)},id:"duration"}):Object(r.jsx)("input",{type:"number",className:"form-control",placeholder:"Enter Duration",value:this.props.editDuration,min:0,onChange:function(t){return e.props.onDurationChange(t)},id:"duration"})]}),Object(r.jsx)("div",{className:"form-group text-left",children:Object(r.jsx)(N.a,{label:"Tags",value:this.props.editTags,onAdd:function(t){return e.props.onTagAdd(t)},onDelete:function(t){return e.props.onTagDelete(t)}})})]}),Object(r.jsxs)(V.a,{children:[Object(r.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:function(){return e.props.toggle()},children:"Close"}),Object(r.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(t){return e.props.handleCreateOrEdit(t)},children:this.props.writeOrEditCaption&&Object(r.jsx)("span",{children:this.props.writeOrEditCaption})})]})]})}}]),a}(n.Component),Y=Object(l.e)(J),$=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){var e,t,a,n,s=this;return Object(r.jsxs)(L.a,{isOpen:this.props.showModal,toggle:function(){return s.props.toggle()},children:[Object(r.jsx)(U.a,{toggle:function(){return s.props.toggle()},children:Object(r.jsx)("h5",{className:"modal-title",id:"viewModalLabel",children:"View certificate"})}),Object(r.jsx)(B.a,{children:Object(r.jsx)("table",{className:"table",children:Object(r.jsxs)("tbody",{children:[Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{scope:"row",children:"Name"}),Object(r.jsx)("td",{children:null===(e=this.props.currentItem)||void 0===e?void 0:e.name})]}),Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{scope:"row",children:"Description"}),Object(r.jsx)("td",{children:null===(t=this.props.currentItem)||void 0===t?void 0:t.description})]}),Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{scope:"row",children:"Price"}),Object(r.jsx)("td",{children:null===(a=this.props.currentItem)||void 0===a?void 0:a.price})]}),Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{scope:"row",children:"Duration"}),Object(r.jsx)("td",{children:null===(n=this.props.currentItem)||void 0===n?void 0:n.duration})]}),Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{scope:"row",children:"Created"}),Object(r.jsx)("td",{children:this.props.currentItem&&Object(r.jsx)("span",{children:z.dateParseString(this.props.currentItem.createDate)})})]}),Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{scope:"row",children:"Updated"}),Object(r.jsx)("td",{children:this.props.currentItem&&Object(r.jsx)("span",{children:z.dateParseString(this.props.currentItem.lastUpdateDate)})})]}),Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{scope:"row",children:"Tags"}),Object(r.jsx)("td",{className:"d-flex flex-wrap",children:this.props.currentItem&&this.props.currentItem.tags.map((function(e,t){return Object(r.jsx)("span",{className:"ml-1",children:Object(r.jsxs)(o.b,{to:"/?tagNames="+e,children:["#",e]})})}))})]})]})})}),Object(r.jsx)(V.a,{children:Object(r.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:function(){return s.props.toggle()},children:"Close"})})]})}}]),a}(n.Component),H=Object(l.e)($),G=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).columns=[{dataField:"_lastUpdateDate",text:"Update date",sort:!0,formatter:a.dateFormatter,sortFunc:function(e,t,a,r,n,s){function i(e,t){return e>t?1:e<t?-1:0}return"asc"===a?i(e,t):i(t,e)},onSort:function(e,t){n.setState({sort:"LAST_UPDATE:"+t},(function(){return n.filter()}))}},{dataField:"_name",text:"Name",sort:!0,onSort:function(e,t){n.setState({sort:"NAME:"+t},(function(){return n.filter()}))}},{dataField:"_tags",text:"Tags",formatter:a.tagsFormatter},{dataField:"_description",text:"Description"},{dataField:"_price",text:"Price"},{text:"Actions",formatter:function(e,t){return Object(r.jsxs)("div",{children:[Object(r.jsx)("button",{className:"btn btn-primary",onClick:function(){return n.setState({currentItem:t,showViewModal:!0})},children:"View"}),Object(r.jsx)("button",{className:"btn btn-success",onClick:function(){n.setState({currentItem:t,editDescription:t.description,editName:t.name,editDuration:t.duration,editPrice:t.price,editTags:Object(d.a)(t.tags),writeOrEditCaption:"Edit",showCreateOrEditModal:!0,wrongEditName:!1,wrongEditDescription:!1,errModalText:null})},children:"Edit"}),Object(r.jsx)("button",{type:"button",onClick:function(){return n.setState({currentItem:t})},className:"btn btn-primary","data-toggle":"modal","data-target":"#deleteModal",children:"Delete"})]})}}],n.state={editDescription:"",editDuration:0,editName:"",editPrice:0,editTags:[],items:[],partName:"",partDescription:"",pageNumber:1,pageSize:5,totalPageCount:1e3,tagNames:[],sort:"LAST_UPDATE:desc",filterString:[],showCreateOrEditModal:!1,showViewModal:!1,wrongEditName:!1,wrongEditDescription:!1},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){this.checkForAdmin(),this.loadResources(this.props.location.search),this.buildSearch(this.props.location.search)}},{key:"buildSearch",value:function(e){var t=new URLSearchParams(e),a=t.get("tagNames");a&&this.setState({tagNames:a.split(",")});var r=t.get("pageSize");r&&this.setState({pageSize:Number.parseInt(r)});var n=t.get("pageNumber");n&&this.setState({pageNumber:Number.parseInt(n)});var s=t.get("partName");console.log("partName in buildSearch = "+s),s&&this.setState({partName:s});var i=t.get("partDescription");i&&this.setState({partDescription:i});var c=t.get("sort");c&&this.setState({sort:c})}},{key:"loadResources",value:function(e){var t=this,a="http://localhost:8080/certificates"+e;console.log("loadResources, location = "+e),b.a.get(a).then((function(e){var a=e.data.items,r=e.data.totalPageCount;console.log("data = "+a),console.log("totalPageCount = "+r);var n=g.parseCertificateList(a);t.setState({items:n,totalPageCount:r})})).catch((function(a){console.log("error = "+a),y.handleTokenExpired(a,(function(){return t.loadResources(e)}),(function(){return window.location.reload()}))}))}},{key:"render",value:function(){var e=this;return Object(r.jsxs)("div",{className:"bg-light",children:[Object(r.jsx)(O,{cartItems:f.calcItemCount()}),Object(r.jsxs)("main",{className:"mt-5 pt-5",children:[Object(r.jsxs)("div",{className:"container",children:[Object(r.jsxs)("div",{className:"text-center my-5 d-flex align-content-end justify-content-center",children:[Object(r.jsx)(N.a,{label:"Filter",value:this.filterValue(),onAdd:function(t){var a=new RegExp("^(#\\().+\\)$");t.match(a)?e.setState((function(e){return{tagNames:[].concat(Object(d.a)(e.tagNames),[t.substr(2,t.length-3)])}})):e.setState({partName:t})},onDelete:function(t){var a=new RegExp("^(#\\().+\\)$");t.match(a)?e.setState({tagNames:e.state.tagNames.filter((function(e){return e!==t.substr(2,t.length-3)}))}):e.setState({partName:""})}}),Object(r.jsx)("div",{className:"ml-3 d-flex",children:Object(r.jsx)("button",{className:"btn btn-primary align-self-end",onClick:function(){return e.filter()},children:"Filter"})})]}),Object(r.jsx)("div",{className:"text-center",children:Object(r.jsx)("button",{className:"btn btn-primary",onClick:function(){e.setState({currentItem:null}),e.setState({editDescription:"",editName:"",editDuration:0,editPrice:0,editTags:[],writeOrEditCaption:"Create",showCreateOrEditModal:!0,wrongEditName:!1,wrongEditDescription:!1,errModalText:null})},children:"Create"})})]}),this.state.err_msg&&Object(r.jsx)("div",{className:"alert alert-warning",role:"alert",children:this.state.err_msg}),Object(r.jsx)("div",{className:"filter__part"}),Object(r.jsx)("div",{className:"table__content m-5",children:Object(r.jsx)(R.a,{bootstrap4:!0,keyField:"id",data:this.state.items,columns:this.columns})}),Object(r.jsx)(k,{pageNumber:this.state.pageNumber,pageSize:this.state.pageSize,totalPageCount:this.state.totalPageCount,onClickPagination:function(t,a){return e.onClickPagination(t,a)},changePageSize:function(t){return e.changePageSize(t)}}),Object(r.jsx)("div",{className:"modal fade",id:"deleteModal",tabIndex:-1,role:"dialog","aria-labelledby":"deleteModalLabel","aria-hidden":"true",children:Object(r.jsx)("div",{className:"modal-dialog",role:"document",children:Object(r.jsxs)("div",{className:"modal-content",children:[Object(r.jsxs)("div",{className:"modal-header",children:[Object(r.jsx)("h5",{className:"modal-title",id:"deleteModalLabel",children:"Delete certificate"}),Object(r.jsx)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",children:Object(r.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(r.jsxs)("div",{className:"modal-body",children:[Object(r.jsx)("span",{children:"Are you sure you want to delete certificate with name "}),this.state.currentItem&&Object(r.jsx)("span",{children:this.state.currentItem.name})]}),Object(r.jsxs)("div",{className:"modal-footer",children:[Object(r.jsx)("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal",children:"Close"}),Object(r.jsx)("button",{type:"button",className:"btn btn-primary","data-dismiss":"modal",onClick:function(t){return e.handleDeleteItem(t)},children:"Delete"})]})]})})}),Object(r.jsx)(Y,{editTags:this.state.editTags,editDescription:this.state.editDescription,editDuration:this.state.editDuration,editName:this.state.editName,editPrice:this.state.editPrice,showCreateOrEditModal:this.state.showCreateOrEditModal,writeOrEditCaption:this.state.writeOrEditCaption,toggle:function(){return e.toggleCreateOrEditModal()},onNameChange:function(t){t.target.value.length<=255&&e.setState({editName:t.target.value,wrongEditName:!1})},onDescriptionChange:function(t){t.target.value.length<=500&&e.setState({editDescription:t.target.value,wrongEditDescription:!1})},onPriceChange:function(t){console.log("price = ",Number.parseFloat(t.target.value)),e.setState({editPrice:Number.parseFloat(t.target.value)})},onDurationChange:function(t){return e.setState({editDuration:Number.parseFloat(t.target.value)})},onTagAdd:function(t){t.length<255&&e.setState((function(e){return{editTags:[].concat(Object(d.a)(e.editTags),[t])}}))},onTagDelete:function(t){return e.setState({editTags:e.state.editTags.filter((function(e){return e!==t}))})},handleCreateOrEdit:function(t){return e.handleCreateOrEdit(t)},wrongEditName:this.state.wrongEditName,wrongEditDescription:this.state.wrongEditDescription,errText:this.state.errModalText}),Object(r.jsx)(H,{currentItem:this.state.currentItem,showModal:this.state.showViewModal,toggle:function(){return e.toggleViewModal()}})]})]})}},{key:"toggleCreateOrEditModal",value:function(){this.setState((function(e){return{showCreateOrEditModal:!e.showCreateOrEditModal}}))}},{key:"toggleViewModal",value:function(){this.setState((function(e){return{showViewModal:!e.showViewModal}}))}},{key:"handleDeleteItem",value:function(e){var t=this;if(this.state.currentItem){var a="http://localhost:8080/certificates/"+this.state.currentItem.id;b.a.delete(a).then((function(){t.filter()})).catch((function(a){"4044"===a.response.data.errorCode&&t.setState({err_msg:"Certificate not already deleted"}),console.log("error = "+a),y.handleTokenExpired(a,(function(){return t.handleDeleteItem(e)}),(function(){return window.location.reload()}))}))}}},{key:"changePageSize",value:function(e){var t=this;this.setState((function(){return{pageNumber:1,pageSize:Number.parseInt(e.target.value)}}),(function(){return t.filter()}))}},{key:"onClickPagination",value:function(e,t){var a=this;e.preventDefault(),console.log("onclick pagination = "+t),this.setState({pageNumber:t},(function(){return a.filter()}))}},{key:"filter",value:function(){if(!this.checkForAdmin()){var e=new URLSearchParams(this.props.location.search);S.setParamQuery(e,this.state.partName,"partName"),S.setParamQuery(e,this.state.partDescription,"partDescription"),S.setParamQuery(e,this.state.pageNumber,"pageNumber"),S.setParamQuery(e,this.state.pageSize,"pageSize"),S.setParamQuery(e,this.state.sort,"sort"),S.setParamQueryArray(e,this.state.tagNames,"tagNames");var t="?"+e.toString();this.props.history.replace(t),this.loadResources(t),this.buildSearch(t)}}},{key:"handleCreateOrEdit",value:function(e){this.validateCreateOrEdit()&&(this.state.currentItem?this.edit(e):this.create(e))}},{key:"edit",value:function(e){var t=this;if(this.state.currentItem){var a="http://localhost:8080/certificates/"+this.state.currentItem.id,r={name:this.state.editName,description:this.state.editDescription,price:this.state.editPrice,duration:this.state.editDuration,tags:this.state.editTags.map((function(e){return{name:e}}))};b.a.patch(a,r).then((function(){t.setState({showCreateOrEditModal:!1},(function(){return t.filter()}))})).catch((function(a){y.handleTokenExpired(a,(function(){return t.edit(e)}),(function(){return window.location.reload()})),a.response&&a.response.data&&"4008"===a.response.data.errorCode&&t.setState({errModalText:"Gift certificate with so name already exists"})}))}}},{key:"create",value:function(e){var t=this,a={name:this.state.editName,description:this.state.editDescription,price:this.state.editPrice,duration:this.state.editDuration,tags:this.state.editTags.map((function(e){return{name:e}}))};b.a.post("http://localhost:8080/certificates",a).then((function(){t.setState({pageNumber:1,showCreateOrEditModal:!1},(function(){return t.filter()}))})).catch((function(a){y.handleTokenExpired(a,(function(){return t.create(e)}),(function(){return window.location.reload()})),a.response&&a.response.data&&"4003"===a.response.data.errorCode&&t.setState({errModalText:"Gift certificate with so name already exists"})}))}},{key:"filterValue",value:function(){var e=this.state.tagNames.map((function(e){return"#("+e+")"}));return this.state.partName&&""!==this.state.partName?[this.state.partName].concat(Object(d.a)(e)):Object(d.a)(e)}},{key:"checkForAdmin",value:function(){return"ADMIN"!==localStorage.getItem("role")&&(this.props.history.push("/login"),!0)}},{key:"validateCreateOrEdit",value:function(){var e=!0;return""===this.state.editName&&(this.setState({wrongEditName:!0}),e=!1),""===this.state.editDescription&&(this.setState({wrongEditDescription:!0}),e=!1),(isNaN(this.state.editPrice)||isNaN(this.state.editDuration))&&(e=!1),e}}],[{key:"tagsFormatter",value:function(e,t){return Object(r.jsx)("div",{className:"d-flex flex-wrap",children:e.map((function(e,t){return Object(r.jsx)("span",{className:"mr-1",children:Object(r.jsxs)(o.b,{to:"/?tagNames="+e,children:["#",e]})},t)}))})}},{key:"dateFormatter",value:function(e,t){return Object(r.jsx)("div",{children:z.dateParseString(e)})}}]),a}(n.Component),W=Object(l.e)(G),q=(a(222),a(223),function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){var e=this;return this.props.certificate?Object(r.jsxs)("div",{className:"coupon row mb-3",children:[Object(r.jsxs)("div",{className:"details col-8",children:[Object(r.jsx)("div",{className:"coupon_name",children:this.props.certificate.name}),Object(r.jsx)("div",{className:"coupon_description",children:this.props.certificate.description.substr(0,100)})]}),Object(r.jsxs)("div",{className:"row col-4",children:[Object(r.jsxs)("div",{className:"minus__plus d-flex align-items-center mr-5 justify-content-end",children:[Object(r.jsx)("button",{className:"btn btn-outline-secondary",onClick:function(){return e.props.onMinus()},children:"-"}),Object(r.jsx)("span",{className:"mx-2",children:this.props.size}),Object(r.jsx)("button",{className:"btn btn-outline-secondary",onClick:function(){return e.props.onPlus()},children:"+"})]}),Object(r.jsx)("div",{className:"d-flex justify-content-end align-items-center",children:Object(r.jsxs)("div",{className:"price",children:["$",Math.round(this.props.certificate.price*this.props.size*100)/100]})})]})]}):Object(r.jsxs)("div",{className:"coupon",children:[Object(r.jsxs)("div",{className:"details",children:[Object(r.jsx)("div",{className:"coupon_name"}),Object(r.jsx)("div",{className:"coupon_description"}),Object(r.jsxs)("div",{className:"minus__plus d-flex align-items-center mr-5",children:[Object(r.jsx)("button",{className:"btn btn-outline-secondary",children:"-"}),Object(r.jsx)("span",{className:"mx-2",children:this.props.size}),Object(r.jsx)("button",{className:"btn btn-outline-secondary",children:"+"})]})]}),Object(r.jsx)("div",{className:"d-flex justify-content-end align-items-center",children:Object(r.jsx)("div",{className:"price"})})]})}}]),a}(n.Component)),Z=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var r;return Object(u.a)(this,a),(r=t.call(this,e)).state={coupons:new Map([])},r}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=Object(D.a)(_.a.mark((function e(){var t,a,r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Array.from(f.getBasket().entries()),console.log("basket comp did mount = "+JSON.stringify(t)),a=new Map([]),r=0;case 4:if(!(r<t.length)){e.next=10;break}return e.next=7,this.buildItem(a,t[r][0],t[r][1]);case 7:r++,e.next=4;break;case 10:this.setState({coupons:a}),console.log("resultBasket = "+JSON.stringify(Array.from(a.entries())));case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"buildItem",value:function(){var e=Object(D.a)(_.a.mark((function e(t,a,r){var n,s=this;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="http://localhost:8080/certificates/"+a,e.next=3,b.a.get(n).then((function(e){var a=e.data;t.set(g.parse(a),r)})).catch((function(e){console.log("error = "+e),y.handleTokenExpired(e,(function(){return s.buildItem(t,a,r)}),(function(){return window.location.reload()})),e.response&&e.response.data&&"4044"===e.response.data.errorCode&&f.removeAllItemBasket(a)}));case 3:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(r.jsxs)("div",{children:[Object(r.jsx)(O,{}),Object(r.jsx)("div",{className:"mt-5 pt-2"}),Object(r.jsx)("div",{className:"header_line",children:Object(r.jsx)("span",{children:"Basket"})}),Object(r.jsx)("main",{className:"checkout",children:Object(r.jsxs)("div",{className:"main_container",children:[Object(r.jsxs)("div",{className:"coupons mt-5",children:[0===this.state.coupons.size&&Object(r.jsx)("h1",{className:"container my-5 py-5",children:"You have not certificates in your basket"}),Array.from(this.state.coupons.entries()).map((function(t,a){return Object(r.jsx)(q,{certificate:t[0],size:t[1],onMinus:function(){return e.onMinus(t)},onPlus:function(){return e.onPlus(t)}},a)}))]}),Object(r.jsx)("div",{className:"line"}),Object(r.jsx)("div",{className:"total_container",children:Object(r.jsxs)("div",{className:"total",children:[Object(r.jsx)("span",{children:"Total"}),Object(r.jsxs)("span",{children:["$",Array.from(this.state.coupons.entries()).map((function(e){return Math.round(e[0].price*e[1]*100)/100})).reduce((function(e,t){return Math.round(100*(e+t))/100}),0)]})]})}),Object(r.jsx)("div",{className:"btn_container",children:Object(r.jsxs)("div",{className:"btn_place",children:[Object(r.jsx)("button",{className:"btn transparent_bg",onClick:function(){e.props.history.push("/")},children:"Back"}),0===this.state.coupons.size?Object(r.jsx)("button",{className:"btn green_bg disabled",children:"Save"}):Object(r.jsx)("button",{className:"btn green_bg",onClick:function(){return e.onFormSubmit()},children:"Save"})]})})]})})]})}},{key:"onMinus",value:function(e){f.removeItemBasket(e[0].id);var t=new Map(this.state.coupons.entries());e[1]-1<1?(t.delete(e[0]),this.setState({coupons:t})):(t.set(e[0],e[1]-1),this.setState({coupons:t}))}},{key:"onPlus",value:function(e){f.putItemBasket(e[0].id);var t=new Map(this.state.coupons.entries());t.set(e[0],e[1]+1),this.setState({coupons:t})}},{key:"onFormSubmit",value:function(){var e,t=this,a=Array.from(this.state.coupons.entries()).map((function(e){return{id:e[0].id,count:e[1]}})),r=f.getRole();if("ADMIN"===r)e={userId:f.getUserId(),giftCertificates:a};else{if("USER"!==r)return void this.props.history.push("/login");e={giftCertificates:a}}b.a.post("http://localhost:8080/orders",e).then((function(){f.clearBasket(),t.props.history.push("/orders")})).catch((function(e){e.response&&e.response.data&&("40128"===e.response.data.errorCode&&t.props.history.push("/login"),"4044"===e.response.data.errorCode&&window.location.reload()),y.handleTokenExpired(e,(function(){return t.onFormSubmit()}),(function(){return window.location.reload()}))}))}}]),a}(n.Component),K=Object(l.e)(Z),X=function(){function e(t,a,r,n){Object(u.a)(this,e),this.certificateId=void 0,this.priceForOne=void 0,this.name=void 0,this.count=void 0,this.certificateId=t,this.priceForOne=a,this.name=r,this.count=n}return Object(h.a)(e,null,[{key:"parseList",value:function(e){for(var t=[],a=0;a<e.length;a++)t.push(this.parse(e[a]));return t}},{key:"parse",value:function(t){return new e(t.certificateId,t.priceForOne,t.name,t.count)}}]),e}(),ee=function(){function e(t,a,r,n){Object(u.a)(this,e),this.id=void 0,this.createDate=void 0,this.price=void 0,this.purchases=void 0,this.id=t,this.createDate=a,this.price=r,this.purchases=n}return Object(h.a)(e,null,[{key:"parseList",value:function(t){for(var a=[],r=0;r<t.length;r++){var n=t[r];a.push(e.parse(n))}return a}},{key:"parse",value:function(t){return new e(t.id,new Date(t.createDate),t.price,X.parseList(t.purchases))}}]),e}(),te=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).columns=[{dataField:"createDate",text:"Date of purchase",formatter:function(e,t){return Object(r.jsx)("div",{children:z.dateParseString(e)})}},{dataField:"price",text:"Price",formatter:function(e,t){return Object(r.jsxs)("div",{children:["$",e]})}}],n.expandRow={renderer:function(e){return Object(r.jsxs)("div",{className:"container text-center",children:[Object(r.jsx)("h2",{className:"mb-3",children:"Certificates:"}),Object(r.jsxs)("table",{className:"table table-striped",children:[Object(r.jsx)("thead",{children:Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{scope:"col",children:"Name"}),Object(r.jsx)("th",{scope:"col",children:"Count"}),Object(r.jsx)("th",{scope:"col",children:"Price"})]})}),Object(r.jsx)("tbody",{children:e.purchases.map((function(e,t){return Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:e.name}),Object(r.jsx)("td",{children:e.count}),Object(r.jsxs)("td",{children:["$",e.priceForOne*e.count]})]})}))})]})]})},showExpandColumn:!0,expandHeaderColumnRenderer:function(e){return e.isAnyExpands?Object(r.jsx)("b",{children:"-"}):Object(r.jsx)("b",{children:"+"})},expandColumnRenderer:function(e){return e.expanded?Object(r.jsx)("b",{children:"-"}):Object(r.jsx)("b",{children:"+"})}},n.state={orders:[],totalPageCount:0,pageNumber:1,pageSize:5},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){this.loadResource(this.props.location.search),this.buildSearch(this.props.location.search)}},{key:"render",value:function(){var e=this;return Object(r.jsxs)("div",{children:[Object(r.jsx)(O,{}),Object(r.jsx)("div",{className:"mt-5 pt-5"}),Object(r.jsx)("main",{children:Object(r.jsxs)("div",{className:"container",children:[Object(r.jsx)("div",{className:"text-center mb-5",children:f.getName()?Object(r.jsxs)("div",{children:[Object(r.jsxs)("h1",{children:["Hello, ",Object(r.jsx)("span",{children:f.getName()})]}),Object(r.jsx)("h1",{children:"This is your orders:"})]}):Object(r.jsx)("h1",{children:"Orders"})}),0===this.state.orders.length?Object(r.jsxs)("div",{children:[Object(r.jsx)(R.a,{bootstrap4:!0,keyField:"id",data:this.state.orders,columns:this.columns,expandRow:this.expandRow}),Object(r.jsxs)("div",{className:"text-center my-5 py-5",children:[Object(r.jsx)("h5",{children:"You have not any orders yet"}),Object(r.jsxs)("h5",{children:["You can ",Object(r.jsx)(o.b,{to:"/",children:"make them"})]})]}),Object(r.jsx)(k,{pageNumber:this.state.pageNumber,pageSize:this.state.pageSize,totalPageCount:this.state.totalPageCount,onClickPagination:function(t,a){return e.onClickPagination(t,a)},changePageSize:function(t){return e.changePageSize(t)}})]}):Object(r.jsxs)("div",{className:"mb-4",children:[Object(r.jsx)(R.a,{bootstrap4:!0,keyField:"id",data:this.state.orders,columns:this.columns,expandRow:this.expandRow}),Object(r.jsx)(k,{pageNumber:this.state.pageNumber,pageSize:this.state.pageSize,totalPageCount:this.state.totalPageCount,onClickPagination:function(t,a){return e.onClickPagination(t,a)},changePageSize:function(t){return e.changePageSize(t)}})]})]})})]})}},{key:"buildSearch",value:function(e){var t=new URLSearchParams(e),a=t.get("pageSize");a&&this.setState({pageSize:Number.parseInt(a)});var r=t.get("pageNumber");r&&this.setState({pageNumber:Number.parseInt(r)})}},{key:"loadResource",value:function(e){var t=f.getRole();null===t?this.props.history.push("/login"):"ADMIN"===t&&this.loadAdmin(e),"USER"===t&&this.loadUser(e)}},{key:"loadAdmin",value:function(e){var t=this;console.log("loadAdmin");var a="http://localhost:8080/orders?userId="+f.getUserId()+"&"+e;b.a.get(a).then((function(e){var a=e.data.items,r=e.data.totalPageCount,n=ee.parseList(a);t.setState({orders:n,totalPageCount:r}),console.log("list = ",n),console.log("totalPageCount = ",r),console.log("success")})).catch((function(e){console.log("error = "+e),y.handleTokenExpired(e,(function(){return t.loadResource(t.props.location.search)}),(function(){return window.location.reload()}))}))}},{key:"loadUser",value:function(e){var t=this,a="http://localhost:8080/orders?"+e;b.a.get(a).then((function(e){var a=e.data.items,r=e.data.totalPageCount,n=ee.parseList(a);t.setState({orders:n,totalPageCount:r})})).catch((function(e){console.log("error = "+e),y.handleTokenExpired(e,(function(){return t.loadResource(t.props.location.search)}),(function(){return window.location.reload()}))}))}},{key:"changePageSize",value:function(e){var t=this;this.setState((function(){return{pageNumber:1,pageSize:Number.parseInt(e.target.value)}}),(function(){return t.filter()}))}},{key:"filter",value:function(){var e=new URLSearchParams(this.props.location.search);S.setParamQuery(e,this.state.pageNumber,"pageNumber"),S.setParamQuery(e,this.state.pageSize,"pageSize");var t=e.toString();this.props.history.replace("/orders?"+t),this.loadResource(t),this.buildSearch("?"+t)}},{key:"onClickPagination",value:function(e,t){var a=this;e.preventDefault(),console.log("onclick pagination = "+t),this.setState({pageNumber:t},(function(){return a.filter()}))}}]),a}(n.Component),ae=Object(l.e)(te);var re=function(){return Object(r.jsx)("div",{className:"App",children:Object(r.jsxs)(o.a,{children:[Object(r.jsx)(l.a,{exact:!0,path:"/",children:Object(r.jsx)(C,{})}),Object(r.jsx)(l.a,{exact:!0,path:"/login",children:Object(r.jsx)(T,{})}),Object(r.jsx)(l.a,{exact:!0,path:"/admin/certificates",children:Object(r.jsx)(W,{})}),Object(r.jsx)(l.a,{exact:!0,path:"/register",children:Object(r.jsx)(F,{})}),Object(r.jsx)(l.a,{exact:!0,path:"/basket",children:Object(r.jsx)(K,{})}),Object(r.jsx)(l.a,{exact:!0,path:"/orders",children:Object(r.jsx)(ae,{})})]})})},ne=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,248)).then((function(t){var a=t.getCLS,r=t.getFID,n=t.getFCP,s=t.getLCP,i=t.getTTFB;a(e),r(e),n(e),s(e),i(e)}))};c.a.render(Object(r.jsx)(s.a.StrictMode,{children:Object(r.jsx)(re,{})}),document.getElementById("root")),ne()}},[[224,1,2]]]);
//# sourceMappingURL=main.f6d3f4c0.chunk.js.map